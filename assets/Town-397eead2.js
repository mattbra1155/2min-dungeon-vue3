var X=Object.defineProperty;var j=(l,o,i)=>o in l?X(l,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[o]=i;var B=(l,o,i)=>(j(l,typeof o!="symbol"?o+"":o,i),i);import{r as W,t as R,d as L,p as D,e as J,f as Q,a as U,q as z,o as T,k as m,h as u,i as e,F as S,v as G,s as I,m as q,$ as Z,g as c,j as d,c as Y,a0 as x,Q as F,S as tt,V as et,x as k,a1 as ot,I as b,a2 as nt,U as V,J as P}from"./index-422a1f0d.js";const K=W({activeShopId:void 0}),M=()=>{const l=o=>{K.activeShopId=o};return{...R(K),setActiveShop:l}},st={key:0,class:"o-interface --town"},it={class:"o-interface__row"},at=["onClick"],rt={class:"o-interface__row"},ct=L({__name:"LayoutInterfaceTown",props:{town:{}},setup(l){const o=l,i=D(),{toggleInventory:n}=J(),{toggleCharacterScreen:s}=Q(),{setActiveShop:a}=M(),{activeGameState:_}=U(),{town:g}=R(o),$=z(()=>i.sceneList.findLast(t=>t)),f=()=>{window.addEventListener("keydown",t=>{t.key==="i"&&n(),t.key==="c"&&s(),t.key,t.key,t.key,t.key})},r=()=>{i.sceneList.find(t=>t.id==="oakwood"),_.value=q.Travel,g.value.activeShopId=void 0,Z.push({name:"home"})},v=t=>{g.value.activeShopId=t,a(t)};return T(()=>{f()}),(t,p)=>m(i).activeRoom&&$.value?(c(),u("div",st,[e("button",{class:"a-button action__button",onClick:p[0]||(p[0]=h=>r())},"Leave Town"),e("div",it,[(c(!0),u(S,null,G(m(g).shops,h=>(c(),u("button",{key:h.id,id:"inventoryButton",type:"button",class:"a-button action__button",onClick:w=>v(h.id)},d(h.name),9,at))),128))]),e("div",rt,[e("button",{id:"inventoryButton",type:"button",class:"a-button action__button",onClick:p[1]||(p[1]=(...h)=>m(n)&&m(n)(...h))}," Inventory "),e("button",{class:"a-button action__button",onClick:p[2]||(p[2]=(...h)=>m(s)&&m(s)(...h))},"Character Screen")])])):I("",!0)}}),{player:C}=Y();class O{constructor(o,i,n,s=[],a=1e3){this.id=o,this.name=i,this.description=n,this.inventory=s,this.gold=a,this.id=o,this.name=i,this.description=n,this.inventory=s,this.gold=a}sellItem(o,i=1){const n=this.inventory.find(a=>a.id===o);if(!n){console.error("SHOP: no item found");return}const s=this.inventory.findIndex(a=>a.id===n.id);this.inventory.splice(s,1),C.value.inventory.gold=C.value.inventory.gold-n.price/i,this.gold=this.gold+n.price,C.value.inventory.addItem(n,C.value.id)}buyItem(o,i=1){C.value.inventory.removeItem(o.id),this.gold=this.gold-o.price,C.value.inventory.gold=C.value.inventory.gold+o.price/i,this.inventory.push(o)}}class lt extends O{constructor(o="merchant",i="merchant",n="lorem ipsum",s=[]){super(o,i,n,s),this.id=o,this.name=i,this.description=n,this.inventory=s}fillInventory(o){let i=0;const n=new F;for(;i<o;){i++;const s=tt();let a;s===1?a=n.createItem(x.Weapon):s===2?a=n.createItem(x.Armor):a=n.createItem(x.Potion),this.inventory.push(a)}}}class ht extends O{constructor(o="blacksmith",i="blacksmith",n="lorem ipsum",s=[]){super(o,i,n,s),this.id=o,this.name=i,this.description=n,this.inventory=s}fillInventory(o){let i=0;const n=new F;for(;i<o;){i++;const s=et();let a;s===1?a=n.createItem(x.Weapon):a=n.createItem(x.Armor),this.inventory.push(a)}}}class dt extends O{constructor(i="tavern",n="Under Three Drops tavern",s="lorem ipsum",a=[],_=[],g=""){super(i,n,s,a);B(this,"getGossipMessage",()=>(console.log(Math.floor(Math.random()*this.gossipList.length)),this.gossipList[Math.floor(Math.random()*this.gossipList.length)]));this.id=i,this.name=n,this.description=s,this.inventory=a,this.gossipList=_,this.gossipWelcome=g}fillInventory(i){let n=0;const s=new F;for(;n<i;){n++;let a;a=s.createItem(x.Food),this.inventory.push(a)}}gossip(){return this.gossipWelcome=`You want to know what's going on in the area?
        You came to the best place!`,this.gossipList=["You probably heard about the scary old castle on the mountainside. It's called Drakehof","There is a old dwaren shrien somwhere in the mountains. It probably has some tresure hidden form the good old days"],{gossipWelcome:this.gossipWelcome,gossipList:this.gossipList}}}const ut={class:"o-merchant"},_t={class:"o-merchant__header"},vt=e("h1",{class:"o-merchant__title"},"Merchant",-1),mt=e("br",null,null,-1),pt={class:"a-text o-merchant__talk"},yt={class:"o-merchant__table"},gt={class:"o-merchant__itemList"},ft=["onClick"],kt={class:"o-merchant__itemName"},bt={class:"o-merchant__itemPrice"},wt={class:"o-merchant__itemList"},$t=["onClick"],It={class:"o-merchant__itemName"},St={class:"o-merchant__itemPrice"},Ct=L({__name:"MerchantShop",setup(l){const{player:o}=Y(),{setActiveShop:i}=M(),n=k(""),s=W(new lt);s.fillInventory(ot());const a=k(!1),_=r=>{let v=0;const t=r,p=50;n.value="",a.value=!0;function h(){v<t.length&&(n.value+=t.charAt(v),v++,setTimeout(h,p))}a.value=!1,h()},g=()=>{i(void 0)},$=r=>{if(s.gold<r.price){_("I don`t have any more gold"),console.log("SHOP: Merchant doesnt have enough gold");return}console.log(a.value),_("Great doing business with you..."),s.buyItem(r,3)},f=r=>{if(o.value.inventory.gold<r.price){_(`You don't have enough gold for ${r.name}`),console.log("SHOP: Player doesnt have enough gold");return}_(`This ${r.name} will help you greatly`),s.sellItem(r.id,.5)};return T(()=>{_("Stay a while and listen...")}),(r,v)=>(c(),u("div",ut,[e("div",_t,[vt,b(" Your Gold: "+d(m(o).inventory.gold)+" ",1),mt,b(" Merchant Gold: "+d(s.gold)+" GC ",1),e("p",pt,d(n.value),1),e("button",{class:"a-button o-merchant__close",onClick:v[0]||(v[0]=t=>g())},"X")]),e("div",yt,[e("div",gt,[b(" SELL: "),(c(!0),u(S,null,G(m(o).inventory.inventory,t=>(c(),u(S,{key:t.id},[t.isEquipped?I("",!0):(c(),u("button",{key:0,class:"a-button o-merchant__item",onClick:p=>$(t)},[e("p",kt,d(t.name),1),e("p",bt,d((t.price/3).toFixed())+" GC",1)],8,ft))],64))),128))]),e("div",wt,[b(" BUY: "),(c(!0),u(S,null,G(s.inventory,t=>(c(),u("button",{onClick:p=>f(t),key:t.id,class:"a-button o-merchant__item"},[e("p",It,d(t.name),1),e("p",St,d(t.price/.5)+" GC",1)],8,$t))),128))])])]))}});var A=(l=>(l.Merchant="merchant",l.Blacksmith="blacksmith",l.Tavern="tavern",l.Library="library",l))(A||{});const N=nt.find(l=>l.id==="town");class Gt{constructor(){B(this,"shops");B(this,"description");this.id="town",this.name="Oakwood",this.description=N==null?void 0:N.description,this.shops=[{id:"merchant",name:"Merchant",inventory:[]},{id:"blacksmith",name:"Blacksmith",inventory:[]},{id:"tavern",name:"Tavern",inventory:[]}],this.activeShopId=void 0}enterMerchantShop(){this.activeShopId="merchant"}}const xt={class:"o-merchant"},Lt={class:"o-merchant__header"},Tt=e("h1",{class:"o-merchant__title"},"Blacksmith",-1),Mt=e("br",null,null,-1),Bt={class:"a-text o-merchant__talk"},Pt={class:"o-merchant__table"},At={class:"o-merchant__itemList"},Wt=["onClick"],Yt={class:"o-merchant__itemName"},Ht={class:"o-merchant__itemPrice"},Nt={class:"o-merchant__itemList"},Ft=["onClick"],Ot={class:"o-merchant__itemName"},Et={class:"o-merchant__itemPrice"},Kt=L({__name:"BlacksmithShop",setup(l){const{player:o}=Y(),{setActiveShop:i}=M(),n=k(""),s=W(new ht);s.fillInventory(V());const a=k(!1),_=r=>{let v=0;const t=r,p=50;n.value="",a.value=!0;function h(){v<t.length&&(n.value+=t.charAt(v),v++,setTimeout(h,p))}a.value=!1,h()},g=()=>{i(void 0)},$=r=>{if(s.gold<r.price){_("I don`t have any more gold"),console.log("SHOP: Blacksmith doesnt have enough gold");return}console.log(a.value),_("Great doing business with you..."),s.buyItem(r,2)},f=r=>{if(o.value.inventory.gold<r.price){_(`You don't have enough gold for ${r.name}`),console.log("SHOP: Player doesnt have enough gold");return}_(`This ${r.name} will help you greatly`),s.sellItem(r.id,.8)};return T(()=>{_("Stay a while and listen...")}),(r,v)=>(c(),u("div",xt,[e("div",Lt,[Tt,b(" Your Gold: "+d(m(o).inventory.gold)+" ",1),Mt,b(" Blacksmith's Gold: "+d(s.gold)+" GC ",1),e("p",Bt,d(n.value),1),e("button",{class:"a-button o-merchant__close",onClick:v[0]||(v[0]=t=>g())},"X")]),e("div",Pt,[e("div",At,[b(" SELL: "),(c(!0),u(S,null,G(m(o).inventory.inventory.filter(t=>t.category==="armor"||t.category==="weapon"||t.category==="material"),t=>(c(),u(S,{key:t.id},[b(d(typeof t)+" ",1),t.isEquipped?I("",!0):(c(),u("button",{key:0,class:"a-button o-merchant__item",onClick:p=>$(t)},[e("p",Yt,d(t.name),1),e("p",Ht,d((t.price/2).toFixed())+" GC",1)],8,Wt))],64))),128))]),e("div",Nt,[b(" BUY: "),(c(!0),u(S,null,G(s.inventory,t=>(c(),u("button",{onClick:p=>f(t),key:t.id,class:"a-button o-merchant__item"},[e("p",Ot,d(t.name),1),e("p",Et,d((t.price/.8).toFixed())+" GC",1)],8,Ft))),128))])])]))}}),Rt={class:"o-merchant"},Dt={class:"o-merchant__header"},Ut=e("h1",{class:"o-merchant__title"},"Tavern",-1),qt=e("br",null,null,-1),Vt={class:"a-text o-merchant__talk"},Xt={key:0},jt={key:0,class:"o-merchant__table"},Jt={class:"o-merchant__itemList"},Qt=["onClick"],zt={class:"o-merchant__itemName"},Zt={class:"o-merchant__itemPrice"},te={class:"o-merchant__itemList"},ee=["onClick"],oe={class:"o-merchant__itemName"},ne={class:"o-merchant__itemPrice"},se=L({__name:"TavernShop",setup(l){const{player:o}=Y(),{setActiveShop:i}=M(),n=k(""),s=k(),a=W(new dt),_=k(!1),g=k(!1),$=k(!1);a.fillInventory(2+V()),a.gossip();const f=h=>{let w=0;const y=h,H=50;n.value="",_.value=!0;function E(){w<y.length&&(n.value+=y.charAt(w),w++,setTimeout(E,H))}_.value=!1,E()},r=()=>{i(void 0)},v=h=>{if(a.gold<h.price){f("I don`t have any more gold"),console.log("SHOP: Tavern Keeper doesnt have enough gold");return}console.log(_.value),f("Great doing business with you..."),a.buyItem(h,2)},t=h=>{if(o.value.inventory.gold<h.price){f(`You don't have enough gold for ${h.name}`),console.log("SHOP: Player doesnt have enough gold");return}f(`This ${h.name} will help you greatly`),a.sellItem(h.id,.8)},p=()=>{$.value=!0,n.value=a.gossipWelcome,s.value=a.getGossipMessage()};return T(()=>{f("Stay a while and listen...")}),(h,w)=>(c(),u("div",Rt,[e("div",Dt,[Ut,b(" Your Gold: "+d(m(o).inventory.gold)+" ",1),qt,b(" Tavern Keeper's Gold: "+d(a.gold)+" GC ",1),e("p",Vt,d(n.value),1),$.value?(c(),u("p",Xt,d(s.value),1)):I("",!0),e("button",{class:"a-button o-merchant__close",onClick:w[0]||(w[0]=y=>r())},"X"),e("div",null,[e("button",{class:"a-button",onClick:w[1]||(w[1]=y=>p())},"Gossip"),e("button",{class:"a-button",onClick:w[2]||(w[2]=y=>g.value=!g.value)},"Buy/sell")])]),g.value?(c(),u("div",jt,[e("div",Jt,[b(" SELL: "),(c(!0),u(S,null,G(m(o).inventory.inventory.filter(y=>y.category==="food"),y=>(c(),u(S,{key:y.id},[y.isEquipped?I("",!0):(c(),u("button",{key:0,class:"a-button o-merchant__item",onClick:H=>v(y)},[e("p",zt,d(y.name),1),e("p",Zt,d((y.price/2).toFixed())+" GC",1)],8,Qt))],64))),128))]),e("div",te,[b(" BUY: "),(c(!0),u(S,null,G(a.inventory,y=>(c(),u("button",{onClick:H=>t(y),key:y.id,class:"a-button o-merchant__item"},[e("p",oe,d(y.name),1),e("p",ne,d((y.price/.8).toFixed())+" GC",1)],8,ee))),128))])])):I("",!0)]))}}),ie={class:"o-town"},ae={class:"o-town__header"},re=["src"],ce={class:"o-town__content"},le=["innerHTML"],ue=L({__name:"Town",setup(l){const{activeRoom:o}=D(),{activeShopId:i}=M(),{activeGameState:n}=U(),s=new Gt;n.value=q.Town,k(""),k("");const a=k(!1),_=k(""),g=f=>{let r=0;const v=f,t=10;_.value="";function p(){r<v.length?(_.value+=v.charAt(r),r++,setTimeout(p,t)):a.value=!0}p()},$=k();return T(()=>{s.shortDescription&&g(s.shortDescription),console.log($)}),(f,r)=>{var v;return c(),u("div",ie,[e("div",ae,[e("h1",null,d((v=m(o))==null?void 0:v.name),1)]),e("img",{class:"o-town__image",src:"images/placeholderTown2.jpeg",alt:""},null,8,re),e("div",ce,[e("div",{class:"o-town__description --short",innerHTML:_.value},null,8,le)]),m(i)===void 0?(c(),P(ct,{key:0,town:m(s)},null,8,["town"])):I("",!0),m(i)===m(A).Merchant?(c(),P(Ct,{key:1})):I("",!0),m(i)===m(A).Blacksmith?(c(),P(Kt,{key:2})):I("",!0),m(i)===m(A).Tavern?(c(),P(se,{key:3})):I("",!0)])}}});export{ue as default};
