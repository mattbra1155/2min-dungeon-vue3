var Q=Object.defineProperty;var Z=(u,r,o)=>r in u?Q(u,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[r]=o;var A=(u,r,o)=>(Z(u,typeof r!="symbol"?r+"":r,o),o);import{r as Y,t as U,d as P,q as X,e as ee,f as te,a as F,s as oe,o as x,i as k,h,j as e,F as I,v as T,l as C,p as V,B as se,g as c,k as v,c as ne,a0 as B,J as K,W as re,Y as ie,x as _,a1 as ae,M as $,a2 as le,X as j,L as H}from"./index-3fb9effd.js";const q=Y({activeShopId:void 0}),W=()=>{const u=r=>{q.activeShopId=r};return{...U(q),setActiveShop:u}},ce={key:0,class:"o-interface --town"},ue={class:"o-interface__row"},de=["onClick"],he={class:"o-interface__row"},ve=P({__name:"LayoutInterfaceTown",props:{town:{}},setup(u){const r=X(),{toggleInventory:o}=ee(),{toggleCharacterScreen:i}=te(),{setActiveShop:a}=W(),l=F(),p=u,{town:d}=U(p),m=oe(()=>r.sceneList.findLast(s=>s)),w=()=>{window.addEventListener("keydown",s=>{s.key==="i"&&o(),s.key==="c"&&i(),s.key,s.key,s.key,s.key})},f=()=>{r.sceneList.find(s=>s.id==="oakwood"),l.activeGameState=V.Travel,d.value.activeShopId=void 0,se.push({name:"home"})},b=s=>{d.value.activeShopId=s,a(s)};return x(()=>{w()}),(s,t)=>k(r).activeRoom&&m.value?(c(),h("div",ce,[e("button",{class:"a-button action__button",onClick:t[0]||(t[0]=n=>f())},"Leave Town"),e("div",ue,[(c(!0),h(I,null,T(k(d).shops,n=>(c(),h("button",{key:n.id,id:"inventoryButton",type:"button",class:"a-button action__button",onClick:G=>b(n.id)},v(n.name),9,de))),128))]),e("div",he,[e("button",{id:"inventoryButton",type:"button",class:"a-button action__button",onClick:t[1]||(t[1]=(...n)=>k(o)&&k(o)(...n))}," Inventory "),e("button",{class:"a-button action__button",onClick:t[2]||(t[2]=(...n)=>k(i)&&k(i)(...n))},"Character Screen")])])):C("",!0)}}),M=ne();class R{constructor(r,o,i,a=[],l=1e3){this.id=r,this.name=o,this.description=i,this.inventory=a,this.gold=l,this.id=r,this.name=o,this.description=i,this.inventory=a,this.gold=l}sellItem(r,o=1){if(!M.player){console.error("No Player");return}const i=this.inventory.find(l=>l.id===r);if(!i){console.error("SHOP: no item found");return}const a=this.inventory.findIndex(l=>l.id===i.id);this.inventory.splice(a,1),M.player.inventory.gold=M.player.inventory.gold-i.price*o,this.gold=this.gold+i.price*o,M.player.inventory.addItem(i,M.player.id)}buyItem(r,o=1){if(!M.player){console.error("No Player");return}M.player.inventory.removeItem(r.id),this.gold=this.gold-r.price*o,M.player.inventory.gold=M.player.inventory.gold+r.price*o,this.inventory.push(r)}}class pe extends R{constructor(r="merchant",o="merchant",i="lorem ipsum",a=[]){super(r,o,i,a),this.id=r,this.name=o,this.description=i,this.inventory=a}fillInventory(r){let o=0;const i=new K;for(;o<r;){o++;const a=re();let l;a===1?l=i.createItem(B.Weapon):a===2?l=i.createItem(B.Armor):l=i.createItem(B.Potion),this.inventory.push(l)}}}class _e extends R{constructor(r="blacksmith",o="blacksmith",i="lorem ipsum",a=[]){super(r,o,i,a),this.id=r,this.name=o,this.description=i,this.inventory=a}fillInventory(r){let o=0;const i=new K;for(;o<r;){o++;const a=ie();let l;a===1?l=i.createItem(B.Weapon):l=i.createItem(B.Armor),this.inventory.push(l)}}}class me extends R{constructor(o="tavern",i="Under Three Drops tavern",a="lorem ipsum",l=[],p=[],d=""){super(o,i,a,l);A(this,"getGossipMessage",()=>this.gossipList[Math.floor(Math.random()*this.gossipList.length)]);this.id=o,this.name=i,this.description=a,this.inventory=l,this.gossipList=p,this.gossipWelcome=d}fillInventory(o){let i=0;const a=new K;for(;i<o;){i++;let l;l=a.createItem(B.Food),this.inventory.push(l)}}gossip(){return this.gossipWelcome="Here is some rumors I heard:",this.gossipList=["You probably heard about the scary old castle on the mountainside. It's called Drakehof","There is a old dwaren shrine somewhere in the mountains. It probably has some tresure hidden form the good old days"],{gossipWelcome:this.gossipWelcome,gossipList:this.gossipList}}}const ye={class:"o-merchant"},ge={class:"o-merchant__header"},fe={class:"a-text o-merchant__talk"},ke={class:"o-merchant__table"},be={class:"o-merchant__itemList"},we=["onClick"],Se={class:"o-merchant__itemName"},$e={class:"o-merchant__itemPrice"},Ie={class:"o-merchant__itemList"},Ce=["onClick"],Ge={class:"o-merchant__itemName"},Me={class:"o-merchant__itemPrice"},Le=P({__name:"MerchantShop",setup(u){const r=usePlayerStore(),{setActiveShop:o}=W(),i=_(3),a=_(.5),l=_(""),p=Y(new pe);p.fillInventory(ae());const d=_(!1),m=s=>{let t=0;const n=s,G=50;l.value="",d.value=!0;function L(){t<n.length&&(l.value+=n.charAt(t),t++,setTimeout(L,G))}d.value=!1,L()},w=()=>{o(void 0)},f=s=>{if(p.gold<s.price){m("I don`t have any more gold"),console.log("SHOP: Merchant doesnt have enough gold");return}console.log(d.value),m("Great doing business with you..."),p.buyItem(s,a.value)},b=s=>{if(r.player.inventory.gold<s.price){m(`You don't have enough gold for ${s.name}`),console.log("SHOP: Player doesnt have enough gold");return}m(`This ${s.name} will help you greatly`),p.sellItem(s.id,i.value)};return x(()=>{m("Stay a while and listen...")}),(s,t)=>(c(),h("div",ye,[e("div",ge,[t[1]||(t[1]=e("h1",{class:"o-merchant__title"},"Merchant",-1)),$(" Your Gold: "+v(s.player.inventory.gold)+" ",1),t[2]||(t[2]=e("br",null,null,-1)),$(" Merchant Gold: "+v(p.gold)+" GC ",1),e("p",fe,v(l.value),1),e("button",{class:"a-button o-merchant__close",onClick:t[0]||(t[0]=n=>w())},"X")]),e("div",ke,[e("div",be,[t[3]||(t[3]=$(" SELL: ")),(c(!0),h(I,null,T(s.player.inventory.inventory,n=>(c(),h(I,{key:n.id},[n.isEquipped?C("",!0):(c(),h("button",{key:0,class:"a-button o-merchant__item",onClick:G=>f(n)},[e("p",Se,v(n.name),1),e("p",$e,v(n.price*a.value)+" GC",1)],8,we))],64))),128))]),e("div",Ie,[t[4]||(t[4]=$(" BUY: ")),(c(!0),h(I,null,T(p.inventory,n=>(c(),h("button",{onClick:G=>b(n),key:n.id,class:"a-button o-merchant__item"},[e("p",Ge,v(n.name),1),e("p",Me,v(n.price*i.value)+" GC",1)],8,Ce))),128))])])]))}});var N=(u=>(u.Merchant="merchant",u.Blacksmith="blacksmith",u.Tavern="tavern",u.Library="library",u))(N||{});const E=le.find(u=>u.id==="town");class Te{constructor(){A(this,"shops");A(this,"description");this.id="town",this.name="Oakwood",this.description=E==null?void 0:E.description,this.shops=[{id:"merchant",name:"Merchant",inventory:[]},{id:"blacksmith",name:"Blacksmith",inventory:[]},{id:"tavern",name:"Tavern",inventory:[]}],this.activeShopId=void 0}enterMerchantShop(){this.activeShopId="merchant"}}const Be={class:"o-merchant"},Pe={class:"o-merchant__header"},xe={class:"a-text o-merchant__talk"},We={class:"o-merchant__table"},Ae={class:"o-merchant__itemList"},He=["onClick"],Ne={class:"o-merchant__itemName"},Ye={class:"o-merchant__itemPrice"},Oe={class:"o-merchant__itemList"},Ee=["onClick"],Ke={class:"o-merchant__itemName"},Re={class:"o-merchant__itemPrice"},De=P({__name:"BlacksmithShop",setup(u){const r=usePlayerStore(),{setActiveShop:o}=W(),i=_(2),a=_(.5),l=_(""),p=Y(new _e);p.fillInventory(j());const d=_(!1),m=s=>{let t=0;const n=s,G=50;l.value="",d.value=!0;function L(){t<n.length&&(l.value+=n.charAt(t),t++,setTimeout(L,G))}d.value=!1,L()},w=()=>{o(void 0)},f=s=>{if(p.gold<s.price){m("I don`t have any more gold"),console.log("SHOP: Blacksmith doesnt have enough gold");return}console.log(d.value),m("Great doing business with you..."),p.buyItem(s,a.value)},b=s=>{if(r.player.inventory.gold<s.price){m(`You don't have enough gold for ${s.name}`),console.log("SHOP: Player doesnt have enough gold");return}m(`This ${s.name} will help you greatly`),p.sellItem(s.id,i.value)};return x(()=>{m("Stay a while and listen...")}),(s,t)=>(c(),h("div",Be,[e("div",Pe,[t[1]||(t[1]=e("h1",{class:"o-merchant__title"},"Blacksmith",-1)),$(" Your Gold: "+v(s.player.inventory.gold)+" ",1),t[2]||(t[2]=e("br",null,null,-1)),$(" Blacksmith's Gold: "+v(p.gold)+" GC ",1),e("p",xe,v(l.value),1),e("button",{class:"a-button o-merchant__close",onClick:t[0]||(t[0]=n=>w())},"X")]),e("div",We,[e("div",Ae,[t[3]||(t[3]=$(" SELL: ")),(c(!0),h(I,null,T(s.player.inventory.inventory.filter(n=>n.category==="armor"||n.category==="weapon"||n.category==="material"),n=>(c(),h(I,{key:n.id},[n.isEquipped?C("",!0):(c(),h("button",{key:0,class:"a-button o-merchant__item",onClick:G=>f(n)},[e("p",Ne,v(n.name),1),e("p",Ye,v(n.price*a.value)+" GC",1)],8,He))],64))),128))]),e("div",Oe,[t[4]||(t[4]=$(" BUY: ")),(c(!0),h(I,null,T(p.inventory,n=>(c(),h("button",{onClick:G=>b(n),key:n.id,class:"a-button o-merchant__item"},[e("p",Ke,v(n.name),1),e("p",Re,v(n.price*i.value)+" GC",1)],8,Ee))),128))])])]))}}),qe={class:"o-merchant"},Ue={class:"o-merchant__header"},Xe={class:"a-text o-merchant__talk"},Fe={key:0,class:"o-merchant__gossip"},Ve={key:1,class:"o-merchant__table"},je={class:"o-merchant__itemList"},Je=["onClick"],ze={class:"o-merchant__itemName"},Qe={class:"o-merchant__itemPrice"},Ze={class:"o-merchant__itemList"},et=["onClick"],tt={class:"o-merchant__itemName"},ot={class:"o-merchant__itemPrice"},st=P({__name:"TavernShop",setup(u){const r=usePlayerStore(),{setActiveShop:o}=W(),i=_([]),a=_(""),l=_(),p=_(),d=Y(new me),m=_(!1),w=_(!1),f=_(!1),b=_(2),s=_(.5);d.fillInventory(2+j()),d.gossip();const t=S=>{if(!m.value){m.value=!0;let y=0;const g=S,O=50;a.value="";const D=()=>{if(y<g.length){if(a.value+=g.charAt(y),y++,setTimeout(D,O),y===g.length){m.value=!1,i.value.push(a.value);return}m.value=!0}};D()}},n=()=>{o(void 0)},G=S=>{if(d.gold<S.price){t("I don`t have any more gold"),console.log("SHOP: Tavern Keeper doesnt have enough gold");return}console.log(m.value),t("Great doing business with you..."),d.buyItem(S,s.value)},L=S=>{if(r.player.inventory.gold<S.price){t(`You don't have enough gold for ${S.name}`),console.log("SHOP: Player doesnt have enough gold");return}t(`This ${S.name} will help you greatly`),d.sellItem(S.id,b.value)},J=()=>{f.value=!0,w.value=!1,console.log("here"),t(d.gossipWelcome),console.log("here1"),p.value=d.getGossipMessage(),console.log(d.getGossipMessage()),console.log("here2")},z=()=>{a.value="",t("Here are my wares"),f.value=!1,w.value=!0};return x(()=>{t("Stay a while and listen...")}),(S,y)=>(c(),h("div",qe,[e("div",Ue,[y[3]||(y[3]=e("h1",{class:"o-merchant__title"},"Tavern",-1)),$(" Your Gold: "+v(S.player.inventory.gold)+" ",1),y[4]||(y[4]=e("br",null,null,-1)),$(" Tavern Keeper's Gold: "+v(d.gold)+" GC ",1),e("p",Xe,v(a.value),1),e("button",{class:"a-button o-merchant__close",onClick:y[0]||(y[0]=g=>n())},"X"),e("div",null,[e("button",{class:"a-button",onClick:y[1]||(y[1]=g=>J())},"Gossip"),e("button",{class:"a-button",onClick:y[2]||(y[2]=g=>z())},"Buy/sell")])]),f.value?(c(),h("div",Fe,[f.value?(c(),h(I,{key:0},[e("p",null,v(l.value),1),e("p",null,v(p.value),1)],64)):C("",!0)])):C("",!0),w.value?(c(),h("div",Ve,[e("div",je,[y[5]||(y[5]=$(" SELL: ")),(c(!0),h(I,null,T(S.player.inventory.inventory.filter(g=>g.category==="food"),g=>(c(),h(I,{key:g.id},[g.isEquipped?C("",!0):(c(),h("button",{key:0,class:"a-button o-merchant__item",onClick:O=>G(g)},[e("p",ze,v(g.name),1),e("p",Qe,v(g.price*s.value)+" GC",1)],8,Je))],64))),128))]),e("div",Ze,[y[6]||(y[6]=$(" BUY: ")),(c(!0),h(I,null,T(d.inventory,g=>(c(),h("button",{onClick:O=>L(g),key:g.id,class:"a-button o-merchant__item"},[e("p",tt,v(g.name),1),e("p",ot,v(g.price*b.value)+" GC",1)],8,et))),128))])])):C("",!0)]))}}),nt={class:"o-town"},rt={class:"o-town__header"},it={class:"o-town__content"},at=["innerHTML"],ut=P({__name:"Town",setup(u){const{activeRoom:r}=X(),{activeShopId:o}=W(),i=F(),a=new Te;i.activeGameState=V.Town,_(""),_("");const l=_(!1),p=_(""),d=w=>{let f=0;const b=w,s=10;p.value="";function t(){f<b.length?(p.value+=b.charAt(f),f++,setTimeout(t,s)):l.value=!0}t()},m=_();return x(()=>{a.shortDescription&&d(a.shortDescription),console.log(m.value)}),(w,f)=>{var b;return c(),h("div",nt,[e("div",rt,[e("h1",null,v((b=k(r))==null?void 0:b.name),1)]),f[0]||(f[0]=e("img",{class:"o-town__image",src:"images/placeholderTown2.jpeg",alt:""},null,-1)),e("div",it,[e("div",{class:"o-town__description --short",innerHTML:p.value},null,8,at)]),k(o)===void 0?(c(),H(ve,{key:0,town:k(a)},null,8,["town"])):C("",!0),k(o)===k(N).Merchant?(c(),H(Le,{key:1})):C("",!0),k(o)===k(N).Blacksmith?(c(),H(De,{key:2})):C("",!0),k(o)===k(N).Tavern?(c(),H(st,{key:3})):C("",!0)])}}});export{ut as default};
